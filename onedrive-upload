#!/bin/bash

script_base_folder=$(dirname "$0")
source "${script_base_folder}/onedrive.cfg"
source "${script_base_folder}/onedrive-base"

if [ -z "$1" ]; then
        echo "Please specify at least one file to upload"
        exit 1
fi

api_access_token=$(acquireAccessToken)
exit_on_error

export api_access_token
printf "%s\0" "${@}" | xargs -0 --max-procs=${max_upload_threads} -i'{}' bash -c "uploadFile \"{}\""
